(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5284],{1025:function(e,t,s){Promise.resolve().then(s.bind(s,8445))},8445:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var r=s(7573),a=s(7653),n=s(7091),l=s(7295),i=s(8253),c=s(7972),o=s(5790),d=s(1827),u=s(9883),m=s(1295),h=s(9670),p=s(734),x=s(5367);class g{setToken(e){this.token=e,localStorage.setItem("counselflow_token",e)}clearToken(){this.token=null,localStorage.removeItem("counselflow_token")}async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s="".concat(this.baseURL).concat(e),r={headers:{"Content-Type":"application/json",...this.token&&{Authorization:"Bearer ".concat(this.token)},...t.headers},...t};try{let e=await fetch(s,r);if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.message||"HTTP ".concat(e.status,": ").concat(e.statusText))}return await e.json()}catch(t){throw console.error("API Request failed: ".concat(e),t),t}}async get(e){return this.request(e)}async post(e,t){return this.request(e,{method:"POST",body:t?JSON.stringify(t):void 0})}async put(e,t){return this.request(e,{method:"PUT",body:t?JSON.stringify(t):void 0})}async delete(e){return this.request(e,{method:"DELETE"})}async login(e,t){return this.request("/auth/login",{method:"POST",body:JSON.stringify({email:e,password:t})})}async register(e){return this.request("/auth/register",{method:"POST",body:JSON.stringify(e)})}async logout(){return this.request("/auth/logout",{method:"POST"})}async refreshToken(){return this.request("/auth/refresh",{method:"POST"})}async getProfile(){return this.request("/auth/profile")}async getClients(e){let t=new URLSearchParams;return(null==e?void 0:e.page)&&t.append("page",e.page.toString()),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(null==e?void 0:e.search)&&t.append("search",e.search),(null==e?void 0:e.status)&&t.append("status",e.status),(null==e?void 0:e.clientType)&&t.append("clientType",e.clientType),this.request("/clients?".concat(t.toString()))}async getClient(e){return this.request("/clients/".concat(e))}async createClient(e){return this.request("/clients",{method:"POST",body:JSON.stringify(e)})}async updateClient(e,t){return this.request("/clients/".concat(e),{method:"PATCH",body:JSON.stringify(t)})}async deleteClient(e){return this.request("/clients/".concat(e),{method:"DELETE"})}async getMatters(e){let t=new URLSearchParams;return(null==e?void 0:e.page)&&t.append("page",e.page.toString()),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(null==e?void 0:e.search)&&t.append("search",e.search),(null==e?void 0:e.status)&&t.append("status",e.status),(null==e?void 0:e.clientId)&&t.append("clientId",e.clientId),this.request("/matters?".concat(t.toString()))}async getMatter(e){return this.request("/matters/".concat(e))}async createMatter(e){return this.request("/matters",{method:"POST",body:JSON.stringify(e)})}async updateMatter(e,t){return this.request("/matters/".concat(e),{method:"PATCH",body:JSON.stringify(t)})}async deleteMatter(e){return this.request("/matters/".concat(e),{method:"DELETE"})}async getContracts(e){let t=new URLSearchParams;return(null==e?void 0:e.page)&&t.append("page",e.page.toString()),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(null==e?void 0:e.search)&&t.append("search",e.search),(null==e?void 0:e.status)&&t.append("status",e.status),(null==e?void 0:e.clientId)&&t.append("clientId",e.clientId),this.request("/contracts?".concat(t.toString()))}async getContract(e){return this.request("/contracts/".concat(e))}async createContract(e){return this.request("/contracts",{method:"POST",body:JSON.stringify(e)})}async updateContract(e,t){return this.request("/contracts/".concat(e),{method:"PATCH",body:JSON.stringify(t)})}async deleteContract(e){return this.request("/contracts/".concat(e),{method:"DELETE"})}async uploadDocument(e,t){let s=new FormData;return s.append("file",e),s.append("metadata",JSON.stringify(t)),this.request("/documents/upload",{method:"POST",headers:{...this.token&&{Authorization:"Bearer ".concat(this.token)}},body:s})}async getDocuments(e){let t=new URLSearchParams;return(null==e?void 0:e.page)&&t.append("page",e.page.toString()),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(null==e?void 0:e.search)&&t.append("search",e.search),(null==e?void 0:e.category)&&t.append("category",e.category),(null==e?void 0:e.relatedId)&&t.append("relatedId",e.relatedId),this.request("/documents?".concat(t.toString()))}async getDocument(e){return this.request("/documents/".concat(e))}async downloadDocument(e){let t=await fetch("".concat(this.baseURL,"/documents/").concat(e,"/download"),{headers:{...this.token&&{Authorization:"Bearer ".concat(this.token)}}});if(!t.ok)throw Error("Failed to download document: ".concat(t.statusText));return t.blob()}async deleteDocument(e){return this.request("/documents/".concat(e),{method:"DELETE"})}async getDashboardMetrics(){return this.request("/dashboard/metrics")}async generateReport(e,t){return this.request("/reports/generate",{method:"POST",body:JSON.stringify({type:e,params:t})})}async getReportStatus(e){return this.request("/reports/".concat(e,"/status"))}async globalSearch(e,t){return this.request("/search",{method:"POST",body:JSON.stringify({query:e,filters:t})})}async healthCheck(){return this.request("/health")}constructor(){this.token=null,this.baseURL="https://api.counselflow.com",this.token=localStorage.getItem("counselflow_token")}}let y=new g;function f(){let[e,t]=(0,a.useState)(""),[s,g]=(0,a.useState)("all"),[f,b]=(0,a.useState)([]),[v,j]=(0,a.useState)(!0),[N,w]=(0,a.useState)(null),[S,k]=(0,a.useState)(!1),[T,C]=(0,a.useState)(null),[A,q]=(0,a.useState)(null),{user:E}=(0,l.useAuth)();(0,a.useEffect)(()=>{O()},[e,s]);let O=async()=>{try{j(!0),w(null);let t=await y.getClients({search:e||void 0,status:"all"!==s?s:void 0});if(t.success&&t.data){let e=t.data.clients.map(e=>({id:e.id,name:e.name,email:e.email,phoneNumber:e.phoneNumber,address:e.address,clientType:e.clientType,industry:e.industry,description:e.description,status:e.status,totalAssets:e.totalAssets,riskScore:e.riskScore,lastActivity:e.lastActivity}));b(e)}else throw Error(t.message||"Failed to load clients");j(!1)}catch(e){console.error("Failed to load clients:",e),w(e.message||"Failed to load clients"),b([]),j(!1)}},P=async e=>{try{if(T)b(f.map(t=>t.id===T.id?{...t,...e}:t));else{let t={id:(f.length+1).toString(),name:e.name||"",email:e.email||"",phoneNumber:e.phoneNumber,address:e.address,clientType:e.clientType||"Individual",industry:e.industry,description:e.description,status:e.status||"Active",totalAssets:e.totalAssets,riskScore:e.riskScore||50,lastActivity:new Date().toISOString().split("T")[0]};b([...f,t])}}catch(e){console.error("Failed to save client:",e),alert("Failed to save client: "+(e.message||"Unknown error"));return}k(!1),C(null)},I=e=>{C(e),k(!0)},D=async e=>{if(confirm("Are you sure you want to delete this client?"))try{b(f.filter(t=>t.id!==e))}catch(e){console.error("Failed to delete client:",e),alert("Failed to delete client: "+(e.message||"Unknown error"))}},L=e=>{q(e)},F=e=>{switch(e){case"Active":return"bg-green-100 text-green-800";case"Inactive":default:return"bg-gray-100 text-gray-800";case"Pending":return"bg-yellow-100 text-yellow-800";case"Suspended":return"bg-red-100 text-red-800"}},R=e=>{switch(e){case"Corporate":return"bg-blue-100 text-blue-800";case"Individual":return"bg-purple-100 text-purple-800";case"Government":return"bg-indigo-100 text-indigo-800";default:return"bg-gray-100 text-gray-800"}},J=f.filter(t=>{let r=t.name.toLowerCase().includes(e.toLowerCase())||t.email.toLowerCase().includes(e.toLowerCase()),a="all"===s||t.status.toLowerCase()===s;return r&&a}),M=[{label:"Total Clients",value:f.length.toString(),change:"+8",icon:i.Z,color:"text-primary-600"},{label:"Active Clients",value:f.filter(e=>"Active"===e.status).length.toString(),change:"+5",icon:c.Z,color:"text-green-600"},{label:"Corporate Clients",value:f.filter(e=>"Corporate"===e.clientType).length.toString(),change:"+2",icon:i.Z,color:"text-blue-600"},{label:"Total Assets",value:"KES ".concat((f.reduce((e,t)=>e+(t.totalAssets||0),0)/1e6).toFixed(1),"M"),change:"+12%",icon:o.Z,color:"text-purple-600"}];return(0,r.jsxs)(n.Z,{children:[(0,r.jsx)("div",{className:"py-6",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 md:px-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-neutral-900",children:"Client Management"}),(0,r.jsx)("p",{className:"mt-2 text-lg text-neutral-600",children:"Manage your client relationships and information"})]}),N&&(0,r.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-md",children:(0,r.jsx)("div",{className:"flex",children:(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error loading client data"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-red-700",children:N})]})})}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4 mb-8",children:M.map(e=>(0,r.jsx)("div",{className:"bg-white rounded-lg border border-neutral-200 shadow-sm p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"p-3 rounded-lg bg-opacity-10 ".concat(e.color.replace("text-","bg-")),children:(0,r.jsx)(e.icon,{className:"h-6 w-6 ".concat(e.color)})})}),(0,r.jsx)("div",{className:"ml-4 w-0 flex-1",children:(0,r.jsxs)("dl",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-neutral-500 truncate",children:e.label}),(0,r.jsxs)("dd",{className:"flex items-baseline",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-neutral-900",children:e.value}),(0,r.jsxs)("div",{className:"ml-2 flex items-baseline text-sm font-semibold text-success-600",children:[(0,r.jsx)(o.Z,{className:"self-center flex-shrink-0 h-4 w-4"}),(0,r.jsx)("span",{className:"ml-1",children:e.change})]})]})]})})]})},e.label))}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"flex flex-1 gap-4",children:[(0,r.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,r.jsx)(d.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-neutral-400 h-4 w-4"}),(0,r.jsx)("input",{type:"text",placeholder:"Search clients...",value:e,onChange:e=>t(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-neutral-300 rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),(0,r.jsxs)("select",{value:s,onChange:e=>g(e.target.value),className:"px-3 py-2 border border-neutral-300 rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[(0,r.jsx)("option",{value:"all",children:"All Status"}),(0,r.jsx)("option",{value:"active",children:"Active"}),(0,r.jsx)("option",{value:"inactive",children:"Inactive"}),(0,r.jsx)("option",{value:"pending",children:"Pending"})]})]}),(0,r.jsxs)("button",{onClick:()=>k(!0),className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white font-medium rounded-md hover:bg-primary-700 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",children:[(0,r.jsx)(u.Z,{className:"h-4 w-4 mr-2"}),"Add Client"]})]}),(0,r.jsx)("div",{className:"bg-white rounded-lg border border-neutral-200 shadow-sm",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-neutral-200",children:[(0,r.jsx)("thead",{className:"bg-neutral-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Client"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Type"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Industry"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Assets"}),(0,r.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-neutral-200",children:v?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:6,className:"px-6 py-12 text-center",children:(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})})})}):0===J.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:6,className:"px-6 py-12 text-center text-neutral-500",children:"No clients found"})}):J.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-neutral-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,r.jsx)("div",{className:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-sm font-medium text-primary-700",children:e.name.charAt(0).toUpperCase()})})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-neutral-900",children:e.name}),(0,r.jsxs)("div",{className:"text-sm text-neutral-500 flex items-center",children:[(0,r.jsx)(m.Z,{className:"h-3 w-3 mr-1"}),e.email]})]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(R(e.clientType)),children:e.clientType})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-neutral-900",children:e.industry||"N/A"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(F(e.status)),children:e.status})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-neutral-900",children:e.totalAssets?"KES ".concat((e.totalAssets/1e6).toFixed(1),"M"):"N/A"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,r.jsx)("button",{onClick:()=>L(e),className:"text-primary-600 hover:text-primary-900",title:"View",children:(0,r.jsx)(h.Z,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:()=>I(e),className:"text-blue-600 hover:text-blue-900",title:"Edit",children:(0,r.jsx)(p.Z,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:()=>D(e.id),className:"text-red-600 hover:text-red-900",title:"Delete",children:(0,r.jsx)(x.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})})})]})}),S&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:T?"Edit Client":"Add New Client"}),(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=new FormData(e.target);P({name:t.get("name"),email:t.get("email"),phoneNumber:t.get("phoneNumber"),address:t.get("address"),clientType:t.get("clientType"),industry:t.get("industry"),description:t.get("description"),status:t.get("status"),totalAssets:parseInt(t.get("totalAssets"))||0,riskScore:parseInt(t.get("riskScore"))||50})},children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name *"}),(0,r.jsx)("input",{type:"text",name:"name",required:!0,defaultValue:null==T?void 0:T.name,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),(0,r.jsx)("input",{type:"email",name:"email",required:!0,defaultValue:null==T?void 0:T.email,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),(0,r.jsx)("input",{type:"tel",name:"phoneNumber",defaultValue:null==T?void 0:T.phoneNumber,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),(0,r.jsx)("input",{type:"text",name:"address",defaultValue:null==T?void 0:T.address,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Type *"}),(0,r.jsxs)("select",{name:"clientType",required:!0,defaultValue:null==T?void 0:T.clientType,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[(0,r.jsx)("option",{value:"",children:"Select Type"}),(0,r.jsx)("option",{value:"Individual",children:"Individual"}),(0,r.jsx)("option",{value:"Corporate",children:"Corporate"}),(0,r.jsx)("option",{value:"Partnership",children:"Partnership"}),(0,r.jsx)("option",{value:"Government",children:"Government"}),(0,r.jsx)("option",{value:"NGO",children:"NGO"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Industry"}),(0,r.jsxs)("select",{name:"industry",defaultValue:null==T?void 0:T.industry,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[(0,r.jsx)("option",{value:"",children:"Select Industry"}),(0,r.jsx)("option",{value:"Technology",children:"Technology"}),(0,r.jsx)("option",{value:"Healthcare",children:"Healthcare"}),(0,r.jsx)("option",{value:"Finance",children:"Finance"}),(0,r.jsx)("option",{value:"Education",children:"Education"}),(0,r.jsx)("option",{value:"Manufacturing",children:"Manufacturing"}),(0,r.jsx)("option",{value:"Retail",children:"Retail"}),(0,r.jsx)("option",{value:"Real Estate",children:"Real Estate"}),(0,r.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,r.jsxs)("select",{name:"status",defaultValue:null==T?void 0:T.status,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[(0,r.jsx)("option",{value:"Active",children:"Active"}),(0,r.jsx)("option",{value:"Inactive",children:"Inactive"}),(0,r.jsx)("option",{value:"Prospect",children:"Prospect"}),(0,r.jsx)("option",{value:"Former",children:"Former"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Assets ($)"}),(0,r.jsx)("input",{type:"number",name:"totalAssets",min:"0",defaultValue:null==T?void 0:T.totalAssets,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,r.jsx)("textarea",{name:"description",rows:3,defaultValue:null==T?void 0:T.description,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Risk Score (0-100)"}),(0,r.jsx)("input",{type:"number",name:"riskScore",min:"0",max:"100",defaultValue:null==T?void 0:T.riskScore,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{k(!1),C(null)},className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:T?"Update Client":"Add Client"})]})]})]})})]})}}},function(e){e.O(0,[3040,3554,7091,1293,4016,1744],function(){return e(e.s=1025)}),_N_E=e.O()}]);